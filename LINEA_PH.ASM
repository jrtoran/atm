; ESCRITURA EN PANTALLA SIN SONDA DE PH LINEA 1 Y 2


LINEA1PH: ; LINEA 3 PORCENTAJE DE PRODUCCION PANTALLA NORMAL CON PH

	LDS				R24,RAMP_PRO
	SBRC			CONTROL, 3		; SALTA LA PROXIMA INSTRUCION SI ES CERO, SUPERCLORACION
	LDI				R24, 100		; SOLO EN CASO DE SUPERCLORACION
	RCALL			RADC			; RUTINA PARA CONVERTIR EN ANALOGICO
	STS				$593, R1		; PONE EN PANTALLA NORMAL
	STS				$594, R2
	STS				$595, R3
	STS				$956, R1		; GRABAR EN RUTINA PROGRAMACION
	STS				$957, R2		; GRABAR EN RUTINA PROGRAMACION
	STS				$958, R3		; GRABAR EN RUTINA PROGRAMACION
	MOV				R16, R19		; ESCRIBIR LINEA 2 valor 128
	RCALL			ENVINT			; En subrrutina Env_doi Envia instrucion para escribir en linea 1
	LDI				YH,HIGH(POR_PRO); POSICION BIT ALTO DEL TEXTO A ENVIAR ram en 070
	LDI				YL,LOW (POR_PRO); POSICION BIT BAJO DEL TEXTO A ENVIAR
	LDI				R17,20			; NUMERO DE DIGITOS A ENVIAR A PANTALLA
	RCALL			ENVIARTEXTO		; RUTINA EN ESTE FICHERO PRECISA SUBRRUTINA ENV_DOI	
	RET

LINEA2PH:		; EN R19 LINEA A ESCRIBIR
	LDI				R16, 32			; PONE UN ESPACIO
	STS				$117,R16			
	STS				$11A,R16
	STS				$120,R16
	STS				$121,R16
	STS				$11E,R16
	STS				$11F,R16
	LDS				R24,RAM_SAL_C		; CARGA DE LA RAM EL VALOR DE LA MEDICION DE LA SAL YA MODIFICADA CON LA TEMPERATURA
	LDI				R16,46			; PONE UN .
	STS				$123,R16	
	CPI				R24,99
	BRBC			0,LINEA2PH_1
	LDI				R16,32
	STS				$7C4,R16
	CPI				R24,61
	BRLO			LINEA2PH_3
	LDI				R24,60				; SI ES MAYOR DE 60 PONE > Y DA VALOR DE 60 A SAL
	LDI				R16,62
	STS				$7C4,R16
LINEA2PH_3:
	RCALL			RADC
;	STS				$122,R1
	STS				$7C5,R2		; VALOR DE LAS DECENAS
	STS				$7C7,R3		; VALOR DE LAS UNIDADES
	RJMP			LINEA2PH_2
LINEA2PH_1:
	LDI				R16, 45			; PONE UN -
	STS				$7C5,R16
	STS				$7C7,R16
LINEA2PH_2:
RET

	MOV				R16, R19			; linea 3 POSICION LINEA A ESCRIBIR
	RCALL			ENVINT
	LDI				YH, HIGH (SAL_AGUA)	; POSICION ALTA DEL TAXTO EN RAM 080
	LDI				YL, LOW  (SAL_AGUA)	; direccion BAJA DEL TEXTO EN RAM      	
 	LDI				R17,20 				; bytes a enviar 
	RCALL			ENVIARTEXTO			; RUTINA PARA ENVIAR TEXTO A PANTALLA
	RET
ANADIR_SAL:
LDI			R16,0
STS			BAJO_SAL,R16			; DESACTIVA BAJO EN SAL
	LDS				R24,RAM_SAL_C		; LEE LA SAL EN EL AGUA
	CPI				R24,lim_sal			; SI ES MAYOR
	BRBC			0,ANADIR_SAL_1		; VA A BORRAR LA LINEA 4
LDI			R16,1
STS			BAJO_SAL,R16			; ACTIVA BAJO EN SAL
	LDI				R18,60
	SUB				R18,R24
	MOV				R24,R18				; RESTA EL VALOR DE 60 GRAMOS LITRO
	RCALL			RADC
	STS				$7D4,R2				; COLOCA EL VALOR DE SAL A AÑADIR
	STS				$7D6,R3				; COLOCA EL VALOR DE SAL A AÑADIR
	CALL			SCR					; MUESTRA SAL A AÑADIR
	RET			
ANADIR_SAL_1:			; BORRA LA LINEA 4
	LDI				R16,212				; 11000000 escribir en linea 4 linea (192)( linea 4 seria 212)
	CALL			ENVINT
	LDI				YH,HIGH(SAL_AGUA)	; POSICION ALTA DEL TAXTO EN RAM 080
	LDI				YL,LOW (SAL_AGUA)	; direccion BAJA DEL TEXTO EN RAM      	
   	LDI				R17,20 				; bytes a enviar 
	CALL			ENVIARTEXTO			; RUTINA PARA ENVIAR TEXTO A PANTALLA
	RET

LIN_AUTO_RD:			; LINEA 3 "PROD. AUTO RDX ---mV"
	MOV				R16,R19				; 11000000 escribir en linea 4 linea (192)( linea 4 seria 212)
	CALL			ENVINT
	LDI				YH,HIGH(AUT_RD)		; POSICION ALTA DEL TAXTO EN RAM 080
	LDI				YL,LOW (AUT_RD)		; direccion BAJA DEL TEXTO EN RAM      	
   	LDI				R17,20 				; bytes a enviar 
	CALL			ENVIARTEXTO			; RUTINA PARA ENVIAR TEXTO A PANTALLA
	RET

LIN_AUTO_CL:			; LINEA 3 "PROD. AUTO CL -.- PPM"
	MOV				R16,R19				; 11000000 escribir en linea 4 linea (192)( linea 4 seria 212)
	CALL			ENVINT
	LDI				YH,HIGH(AUT_CL)		; POSICION ALTA DEL TAXTO EN RAM 080
	LDI				YL,LOW (AUT_CL)		; direccion BAJA DEL TEXTO EN RAM      	
   	LDI				R17,20 				; bytes a enviar 
	CALL			ENVIARTEXTO			; RUTINA PARA ENVIAR TEXTO A PANTALLA

	RET

