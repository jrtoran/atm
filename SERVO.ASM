; CONTROL SERVO SALIDA POR EL PUERTO E5, CONVERTIDOR ANALOGICO CON REFERENCIA A 5 VOLTIOS ENTRADA PUERTO F3 SE헤L DE Ph
; 0 VOLTIOS A -90 1,3 VOLTIOS A +90

SERVO: ; MEDICION DE LA SE헤L DEL POTENCIOMETRO RESULTADO EN R24

;	SBI				PORTE,5			; PONE A 1 LA SE헤L DEL SEVO

							; LINEA DE ENTRADA DE AMPERIOS LA 6 PARA PRUEBAS LA 4 pH
; CONFIGURAR TENSION DE REFERENCIA A 2,5 SE헤L INTERNA, FORMA DE ALMACENAMIENTO CON EL REGISTRO ADLAR A 1 Y CANAL A LEER

	SBI				PORTE,5						; PONE A 1 LA SE헤L DEL SERVO
	CLR				R24
 	LDI				R18, 3						; LENEA DE ENTRADA POTENCIOMETRO
	LDI				R16,0b11100000				; SE헤L DE REFERENCIA A 5 VOLTIOS BIT 7 A CERO PARA SE헤L 2,5 BIT 7 A UNO 0B11100000
	ADD				R16,R18						; EN R18 EL CANAL A LEER Y GANANCIA VER PAG 245
	OUT				ADMUX,R16
	LDI				R16,0B11010111				; PREESCALA A 128 "8.000.000/128=62.500Hz
	OUT				ADCSRA,R16
ADC_P2B_1:
	IN				R16,ADCSRA
	NOP
	BST				R16,6						; CARGA EN EL REGISTRO T DE SREG EL 6 ACSRA
	BRTS			ADC_P2B_1					; SALTA A ADC_P1 SI EL REGISTRO ES UNO SE PONE A CERO AL TERMINAR 
	IN	 			R24,ADCH
	LSR				R24							; DIVIDO ENTRE DOS POR RECORRIDO POTENCIOMETRO
	INC				R24							; SUMO UNO PARA QUE NUNCASEA CERO
	LDI				R19,40						; PARA EL AJUSTE DE CERO VOLTIOS POSICION -90 GRADOS
	ADD				R24,R19

; TRANSCURRE 1 MILISEGUNDO ENTRE 1 Y 2 RECORRIDO MINIMO A MAXIMO
	LDI				R25,250
SERVO1:
	WDR
	NOP
	DEC				R25 
	BRNE			SERVO1 						; HASTA AQUI 1 MILISEGUNDO  		;
	LDI				R25,25
	DEC				R24							; DESPLAZAMIENTO MAXIMO 1 MILISEGUNDO
	BRNE			SERVO1
	CBI				PORTE,5						; CORTA LA SE헤L DEL SERVO
	RET

;	TIEMPO MUERTO SE ANULA EN PROGRAMACION NORMAL ????????????????????????????????????????????????????
LDI			R25,250
LDI			R24,250
SERVO2:
	WDR
	NOP
	DEC				R25 
	BRNE			SERVO2 				; HASTA AQUI 1 MILISEGUNDO  		;
	LDI				R25,250
	DEC				R24					; DESPLAZAMIENTO MAXIMO 1 MILISEGUNDO
	BRNE			SERVO2


RJMP		SERVO
;  HASTA AQUI??????????????????????????????????????????????????????????????????????????????????????????
